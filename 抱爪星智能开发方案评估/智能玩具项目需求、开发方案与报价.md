# 智能玩具项目需求与开发方案

## 一、项目背景与核心需求

### 1.1 熊猫玩偶智能升级项目

**现状**: 硬件已经完成，里面有麦克风、扬声器、各种传感器和主控芯片（类似一个单片机）

**用户需求**: 让玩具能"记住"主人，与用户长期互动中形成独特个性，通过预设动作和叫声表达情感，给予用户认同感和回应。

**通俗理解**: 就是要在玩具里装一个"大脑"，这个大脑能：
- 通过声音认出你是谁（声纹识别）
- 判断你是开心还是难过（情绪识别）
- 记住你上次说了什么（记忆功能）
- 主动找你聊天（主动触发）
- 做出点头、叫唤等反应（动作控制）

**核心难点**: 
- 反应要快，不能你说完话等半天才有反应
- 要合理选择时机，不要老打扰人，也不要太冷淡，强调回复的时机和准确率
- 记忆系统要智能，不能记一堆没用的信息

### 1.2 马年挂件新项目

**用户需求**: 做一个能挂在钥匙扣上的小玩意儿，能播报黄历、根据生辰八字给建议

**通俗理解**: 就是一个会说话的小挂件，按一下按钮就能告诉你今天运势怎么样，适合穿什么衣服

**核心难点**:
- 要用4G网络，不能用WiFi（因为没人会挂WiFi钥匙扣）
- 电池要小，但得能用好几天
- 成本要控制

---

## 二、需求到解决方案的映射

### 2.1 熊猫玩偶: 从需求到技术方案

| 用户需求 | 技术问题 | 解决方案 | 
|----------|----------|----------|
| 能认出主人声音 | 怎么区分不同人的声音？ | 声纹识别系统 | 
| 能判断情绪 | 怎么知道主人开心还是难过？ | 情绪识别模型 | 
| 能记住对话 | 存在哪里？怎么快速找到？ | 混合记忆系统（云） | 
| 能主动聊天 | 什么时候该说话？ | 主动触发引擎（根据关键词、时间、情绪综合判断） | 
| 能做出反应 | 怎么控制玩具动？ | 动作控制模块 | 

**核心数据流**:
```
用户触摸激活（激活与静默切换） → 用户说话 → 声纹识别（判断是谁）→ 语义情绪识别（判断心情）→ 记忆检索（回忆过去）→ 大模型理解（理解意思）→ 主动触发（决定要不要回应）→ 动作组合控制（情绪-动作组合）
```

**记忆系统方案**:
- 不需要复杂的知识图谱
- 每轮对话引到大模型判断分支: 这句话里有没有需要记住的个人信息？
- 有的话就抽出来，存成简单的"关系"（比如"小明喜欢狗"）
- 存的时候用向量检索，方便以后找
- 记忆支持基本的更新、遗忘机制
- 用户“声纹-身份”对应隔离

### 2.2 马年挂件: 从需求到技术方案

| 用户需求 | 技术问题 | 解决方案 | 为什么这么解决 |
|----------|----------|----------|----------------|
| 能播报黄历 | 黄历数据从哪来？ | 调用第三方API + 本地缓存 | 有网络时从网上拿，没网络用缓存 |
| 能算八字 | 怎么根据生辰八字给建议？ | 大模型Prompt工程 | 让AI学习八字知识，然后生成建议 |
| 能语音播报 | 怎么把文字变成声音？ | TTS语音合成服务 | 调用阿里/腾讯的语音合成API |
| 用4G网络 | 怎么联网？ | 4G模块 + 智能休眠 | 不用时让模块睡觉省电 |
| 按键交互 | 怎么操作？ | 物理按键 + LED指示灯 | 简单直观，老人小孩都会用 |

---

## 三、具体要开发什么？

### 3.1 熊猫玩偶开发清单

**核心策略**: **1个月交付**

**核心功能模块**（必须有的）:

1. **声纹识别模块**（约5天工作量）
   - **用开源模型**: 直接拿 `pyannote.audio` 或 `Resemblyzer`（1天）
   - **微调**: 用收集的10-20个样本微调（2天）
   - **开发注册流程**: 录5句话提取声纹（1天）
   - **集成到玩具**: 在ESP32上跑量化模型（1天）

2. **情绪识别模块**（约5天工作量）
   - **用现成API**: 阿里云/腾讯云情绪识别API（1天）
   - **本地兜底**: 用轻量级模型 `emotion2vec`（1天）
   - **规则系统**: 关键词匹配（累/开心/难过）（1天）
   - **动作映射**: 情绪→动作对照表（1天）
   - **集成测试**: 端到端调通（1天）

3. **记忆系统模块**（约7天工作量）⭐最核心 
   - **用向量数据库**: 直接上 `Qdrant Cloud` 免费版（1天）
   - **简化设计**: 只存"用户-属性"键值对（2天）
   - **自动抽取**: 用大模型Prompt自动提取信息（2天）
   - **检索优化**: 用余弦相似度快速匹配（1天）
   - **同步机制**: 网络好时批量上传（1天）

4. **主动触发模块**（约3天工作量）
   - **关键词触发**: 硬编码20个关键词（0.5天）
   - **情绪触发**: 检测到难过立即响应（0.5天）
   - **时间触发**: 定时器（早/晚）（0.5天）
   - **频率控制**: 5分钟内最多触发1次（0.5天）
   - **用户反馈**: 点小程序"太吵了"就降低频率（1天）

5. **语义理解模块**（约3天工作量）
   - **直接调API**: 通义千问/智谱API（1天）
   - **Prompt模板**: 10个场景模板（1天）
   - **意图分类**: 用LLM做零样本分类（0.5天）
   - **个性化**: 在Prompt里加记忆片段（0.5天）

6. **动作控制模块**（约2天工作量）
   - **基础动作**: 点头、摇头、摇摆（0.5天）
   - **组合动作**: 高兴=点头+摇尾巴（0.5天）
   - **同步**: 动作和声音同步（0.5天）
   - **测试**: 调参数让动作自然（0.5天）


**总工作量**: 约28天（4周）

### 3.2 马年挂件开发清单

**核心策略**: 复用熊猫玩偶组件 + 现成服务，**2周交付**
1. **硬件部分**（约3天工作量）⚡复用加速
   - **复用熊猫玩偶主板**: 直接改一下外壳（1天）
   - **4G模块调试**: 用AT指令快速调通（1天）
   - **音频系统**: 复用熊猫玩偶的音频驱动（0.5天）
   - **电源管理**: 复用休眠策略（0.5天）

2. **嵌入式软件**（约4天工作量）
   - **按键检测**: 复用熊猫玩偶代码（0.5天）
   - **音频播放**: 复用音频模块（0.5天）
   - **网络通信**: 用MQTT库，AI生成代码（1天）
   - **离线缓存**: 用SQLite，AI生成CRUD（1天）
   - **协议对接**: 对接云端API（1天）

3. **云端服务**（约3天工作量）⚡现成服务
   - **黄历API**: 直接调用聚合数据API（0.5天）
   - **八字分析**: 用通义千问Prompt工程（1天）
   - **TTS服务**: 复用熊猫玩偶的TTS模块（0.5天）
   - **数据存储**: 复用熊猫玩偶的数据库（0.5天）
   - **API封装**: FastAPI快速开发（0.5天）

4. **小程序**（约2天工作量）⚡模板化
   - **复用熊猫玩偶小程序框架**: 改页面（1天）
   - **八字输入**: 表单页面（0.5天）
   - **运势展示**: 列表+详情（0.5天）

**总工作量**: 约12天（2周）

---

## 四、人员需求

### 4.1 熊猫玩偶团队（3人）

- **AI全栈工程师**（1人）
  - 负责: 声纹识别、情绪识别、主动触发、对接大模型
  - 要求: 会用Copilot/Cursor，懂模型微调，会Python/C
  - 周期: 全程4周
  - **AI工具**: Cursor写代码、Replicate跑模型、Vercel部署

- **嵌入式AI工程师**（1人，资深）
  - 负责: 模型量化、ESP32优化、硬件调试
  - 要求: 懂TFLite，会模型压缩，熟悉ESP32
  - 周期: 全程4周
  - **AI工具**: GitHub Copilot生成驱动代码

- **测试/运维工程师**（1人，玩具生产方）
  - 负责: 自动化测试、部署、监控
  - 要求: 会写测试脚本，懂CI/CD
  - 周期: 第2-4周
  - **AI工具**: CodiumAI生成测试用例、GitHub Actions自动化

### 4.2 马年挂件团队（1人）⚡复用加速

- **嵌入式工程师**（1人，中级）
  - 负责: 复用熊猫玩偶硬件，调试4G
  - 要求: 懂AT指令，会改现有代码
  - 周期: 全程2周
  - **策略**: 90%代码复用熊猫玩偶


### 4.3 团队配置总结

| 项目 | 人数 | 周期 | 核心策略 |
|------|------|------|----------|
| 熊猫玩偶 | 3人 | 4周 | AI工具+精英团队 |
| 马年挂件 | 1人 | 2周 | 复用+共享人员 |
| **峰值人数** | **4人** | - | 比传统方案少50% |


---

## 五、时间规划

### 5.1 熊猫玩偶（4周，1个月）⚡AI时代冲刺计划

```
第1周: 基础搭建 + 核心AI（Week 1）
Day 1-2: 环境搭建 + AI工具配置
- 搭Git仓库、CI/CD、开发环境
- 配置Cursor/Copilot、Qdrant Cloud、通义千问API
- AI生成项目骨架（1小时）

Day 3-5: 声纹识别 + 情绪识别
- Day 3: 集成pyannote.audio，跑通声纹提取
- Day 4: 用10个样本微调，集成到ESP32
- Day 5: 接入阿里云情绪API + emotion2vec本地兜底

第2周: 记忆系统 + 主动触发（Week 2）
Day 6-8: 记忆系统开发
- Day 6: Qdrant Cloud建库，设计"用户-属性"schema
- Day 7: 写Prompt让LLM自动抽取信息，AI生成CRUD代码
- Day 8: 开发记忆检索，余弦相似度匹配

Day 9-10: 主动触发 + 语义理解
- Day 9: 关键词/情绪/时间触发逻辑，5分钟冷却机制
- Day 10: 通义千问Prompt模板，10个场景

第3周: 集成 + 小程序（Week 3）
Day 11-12: Agent集成
- Day 11: 所有模块连起来，端到端测试
- Day 12: 动作控制开发，情绪→动作映射

Day 13-15: 小程序开发
- Day 13: V0.dev生成界面，声纹注册页面
- Day 14: 记忆查看页面，列表展示
- Day 15: 设置页面，开关+滑块

第4周: 测试 + 优化（Week 4）
Day 16-18: 全面测试
- Day 16: 自动化测试（CodiumAI生成用例）
- Day 17: 性能测试，优化响应速度到<200ms
- Day 18: 功耗测试，优化到>7天续航

Day 19-20: 用户试用 + 发布准备
- Day 19: 找5个种子用户试用，收集反馈
- Day 20: 修复bug，准备量产版本
```

### 5.2 马年挂件（2周，半个月）⚡复用加速

```
第1周: 硬件 + 云端（Week 1）
Day 1-2: 硬件复用
- Day 1: 复用熊猫玩偶主板，改外壳
- Day 2: 4G模块AT指令调通

Day 3-5: 云端服务
- Day 3: 对接聚合数据黄历API
- Day 4: 八字分析Prompt工程，通义千问
- Day 5: 复用熊猫玩偶TTS模块

第2周: 设备 + 小程序 + 测试（Week 2）
Day 6-8: 设备功能
- Day 6: 按键检测 + 音频播放
- Day 7: 离线缓存（SQLite）
- Day 8: 网络通信优化（MQTT）

Day 9-10: 小程序 + 测试
- Day 9: 复用熊猫玩偶小程序框架，改八字页面
- Day 10: 功能测试 + 网络稳定性测试 + 功耗测试
```

**并行策略**: 马年挂件第1周与熊猫玩偶第3周并行，最大化复用

---

## 六、成本估算

### 6.1 人力成本

| 角色 | 人数 | 月薪 | 工作月数 | 小计 | 备注 |
|------|------|------|----------|------|------|
| AI全栈工程师（资深） | 1 | 0元 | 1 | 0元 | 公司内部，无成本 |
| 实习生 | 2 | 5,000 | 1 | 10,000元 | 协助开发、测试、文档 |
| 外包测试工程师 | 1 | 10,000 | 0.5 | 5,000元 | 专业测试，按项目外包 |
| 外包运维工程师 | 1 | 10,000 | 0.5 | 5,000元 | 容器化部署、SaaS化 |
| 合计 | 4人峰值 | - | - | 20,000元 | 比原计划节省67% |


### 6.2 其他成本（调试用成本）

| 项目 | 金额 | 说明 | AI优化 |
|------|------|------|--------|
| 大模型API | 500元 | 通义千问/智谱API（1个月） | 按需调用，节省60% |
| 向量数据库 | 0元 | Qdrant Cloud免费版 | 免费 tier 够用 |
| TTS API | 50元 | 阿里/腾讯云TTS | 缓存常用语音 |
| 黄历API | ？ | 聚合数据API | 按次计费 |
| AI工具订阅 | 500元 | Cursor/Copilot/V0.dev | 团队版 |
| 云服务 | 100 元 | 服务器、存储 | Serverless节省50% |
| **总计** | **2,150元** | | 基础成本 |

### 6.3 总成本

| 成本项 | 总价 | 
|--------|------------|
| 人力成本 | 20,000元 |
| 其他成本 | 2,150元 | 
| **总成本** | **22,150元** | 

### 6.4 定价与利润预测

# 6.4.1 报价方案（6w以内版）

| 服务层级 | 包含内容 | 报价 | 成本 | 毛利润 | 毛利率 |
|----------|----------|------|------|--------|--------|
| 基础版 | 熊猫玩偶完整方案+源码+部署文档 | 48,000元 | 22,150元 | 25,850元 | 53.9% |
| 标准版 | 基础版 + 马年挂件方案 + 1个月技术支持 | 58,000元 | 25,150元 | 32,850元 | 56.6% |
| 高级版 | 标准版 + 3个月远程支持 + 定制优化 + 培训 | 60,000元 | 30,000元 | 30,000元 | 50.0% |

## 报价依据：

- 市场同类AI解决方案报价: ？？万

---

## 七、核心风险与应对

### 7.1 技术风险（AI时代新风险）

| 风险 | 可能性 | 影响 | 应对办法 |
|------|--------|------|----------|
| AI生成代码有bug | 中 | 中 | AI生成后必须人工review + 单元测试全覆盖 |
| 大模型API限流 | 中 | 高 | 本地缓存 + 降级到规则系统 + 多API Key轮换 |
| 开源模型效果不佳 | 低 | 中 | 快速切换备选方案（准备2-3个备选） |
| 端侧模型跑不动 | 低 | 高 | 提前验证模型大小 + 量化压缩 + 准备简化版 |

### 7.2 项目风险（小团队特有风险）

| 风险 | 可能性 | 影响 | 应对办法 |
|------|--------|------|----------|
| 人员生病/请假 | 中 | 高 | 交叉备份（每人至少懂2个模块）+ AI补位 |
| AI工具失效 | 低 | 中 | 准备离线版工具 + 传统编码能力保底 |
| 需求膨胀 | 高 | 高 | 严格冻结需求，变更必须砍掉等量的功能 |
| 技术债务累积 | 中 | 中 | 每周五下午固定2小时重构，AI辅助还债 |

---

## 八、成功标准

### 8.1 技术指标
- 声纹识别准确率 >90%
- 情绪识别准确率 >80%
- 端侧响应 <200ms
- 电池续航 >7天（熊猫）/ >5天（马年）

### 8.2 用户体验
- 第一次用就能成功（成功率>90%）
- 每天活跃用户 >60%
- 用户满意度 >4.2分（5分制）
- 愿意推荐给朋友（NPS>40）

---

## 九、核心建议

### 9.1 立即要做的事（第1周）
- 招人: 把核心团队凑齐（AI算法和嵌入式AI最关键）
- 买设备: 买开发板、测试仪器
- 验证技术: 先做个声纹识别的demo，看看效果
- 定规范: 代码怎么写、文档怎么记、怎么测试

### 9.2 技术决策
- ✅ 记忆系统: 用简单的向量检索，不要搞复杂的知识图谱
- ✅ 端侧AI: 一定要快，慢了就没人愿意玩了
- ✅ 声纹识别: 多投入精力，这是核心竞争力
- ✅ 主动触发: 宁可少说话，也不要说错话

### 9.3 项目管理
- 每周开会: 同步进度，解决问题
- 每两周演示: 给老板看看成果，及时调整方向
- 每月复盘: 总结经验教训 

### 9.4 立即要做的事（第1-2天）⚡闪电启动
Day 1: AI工具链部署

1. ✅ 开通AI服务: 通义千问API、Qdrant Cloud、Cursor团队版
2. ✅ 搭开发环境: GitHub仓库、CI/CD流水线、测试环境
3. ✅ AI生成骨架: 用Cursor生成项目基础代码（1小时）

Day 2: 核心验证
4. ✅ 声纹Demo: 用pyannote.audio跑通声纹提取（2小时）
5. ✅ 情绪Demo: 接入阿里云情绪API（2小时）
6. ✅ 记忆Demo: Qdrant建库，写Prompt抽信息（2小时）


### 9.5 AI工具使用规范
| 任务 | AI工具 | 使用方式 | 人工Review |
|------|--------|----------|------------|
| 代码生成 | Cursor/Copilot | 写注释让AI生成 | 必须 |
| 测试用例 | CodiumAI | 自动生成单元测试 | 抽查 |
| 文档编写 | Notion AI | 生成初稿 | 必须 |
| 代码审查 | GitHub Copilot | 自动Review | 关键模块 |
| 性能优化 | AI Profiler | 自动分析瓶颈 | 必须 |
| 故障排查 | AI Debugger | 辅助定位问题 | 必须 |
| 黄金法则 | - | AI生成代码覆盖率>80%，人工聚焦架构和核心算法 | - |

---

## 十、总结（AI时代最新数据）

**需要多少钱？**
💰 **2.3万**（人力2万 + 其他2,150元）

**需要多长时间？**
📅 **熊猫玩偶1个月，马年挂件2周**，可以并行

**需要多少人？**
👥 **峰值4人**（AI全栈+嵌入式AI+测试+挂件工程师）

**最大的风险是什么？**
⚠️ **AI生成代码质量** - 必须严格Code Review

**最大的机会是什么？**
🚀 **AI超级个体** - 1个工程师+AI=3-4个传统工程师

---

**建议**: **立即启动，Day 1部署AI工具链，Day 2验证核心技术**

---

**报告编制**: 技术架构团队
**编制日期**: 2024-11-12
**版本**: v3.0（AI时代加速版）
**阅读建议**: 适合管理层快速决策