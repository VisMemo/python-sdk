# 时空知识记忆系统构建理论 — 文档索引与参考顺序

**目录作用**：为本目录下的理论文档、发展路径规划与图谱 Schema（v0.1/v0.2）建立清晰的关系与阅读顺序，作为后续工程实现与架构演进的“导航图”。

---

## 1. 文档总览

- `理论层（Why & What）/时空知识图谱的本体论与信息论基础.md`  
  - **角色**：第一性原理与数学/哲学框架。  
  - 内容：STH 超图形式化、TimeSlice/Region/事件原语、STF/CI 度量、记忆经济学、不可能三角等。  
  - 面向对象：架构设计者、算法研究者。

- `规划层（How over time）/系统讨论_需求与方案总结.md`  
  - **角色**：当前实现 vs 理论的差距分析与需求清单。  
  - 内容：现有系统问题、时间轴/多租户/图演化/记忆层级的差异与目标、简要 TODO。  
  - 面向对象：整体规划、产品/技术决策。

- `规划层（How over time）/视觉记忆基础设施_发展路径规划.md`  
  - **角色**：工程路线图。  
  - 内容：阶段 1–7（时间轴、多租户、智能图构建、CI/CD、文本记忆、SaaS、TKG 前向推理）的目标、工作项与检验标准。  
  - 面向对象：工程负责人、项目管理。

- `Schema 层（What exactly in code）/TKG-Graph-v0.1-SCHEMA.md`  
  - **角色**：图谱内核 Schema 锚点。  
  - 内容：v0.1 的 5 类核心节点（`MediaSegment`, `Evidence`, `Entity`, `Event`, `Place`）与 6 类边，以及时间、多租户、兼容性约束。  
  - 面向对象：所有与图/存储相关的工程实现（Neo4j/Qdrant/schema/adapter）。

- `Schema 层（What exactly in code）/TKG-Graph-v0.2-EXTENSIONS.md`  
  - **角色**：图谱扩展层 Schema（阶段 3 对应）。  
  - 内容：在 v0.1 之上新增的 `TimeSlice` 节点，以及 `NEXT_EVENT`, `CO_OCCURS_WITH`, `CAUSES`, `SUPPORTED_BY`, `COVERS_SEGMENT/COVERS_EVENT` 等高阶边与分层语义。  
  - 面向对象：事件时间线、关系发现、因果/预测与 TKG 视图实现。

- `PROCESS.md`  
  - **角色**：本目录的迭代过程记录。  
  - 内容：每次主要文档/Schema 变更的时间、内容、测试验证与与总体目标的对齐评估。  
  - 面向对象：架构演进审计、历史回溯。

---

## 2. 理论 ←→ 路线图 ←→ Schema 的关系

可以用三层来理解各文档关系：

1. **理论层（Why & What）**  
   - 代表：`时空知识图谱的本体论与信息论基础.md`。  
   - 定义问题空间与理想解：STH=(V,H,τ,σ,λ)、事件/TimeSlice 本体、STF/CI 指标、记忆经济学、不可能三角等。

2. **规划层（How over time）**  
   - 代表：`系统讨论_需求与方案总结.md` + `视觉记忆基础设施_发展路径规划.md`。  
   - 把理论拆成阶段性目标和工程路径：  
     - 阶段 1–2：时间轴 + 多租户；  
     - 阶段 3：智能图构建与结构化回想；  
     - 阶段 4–7：工程化、文本记忆、SaaS、TKG 前向推理。

3. **Schema 层（What exactly in code）**  
   - 代表：`TKG-Graph-v0.1-SCHEMA.md` + `TKG-Graph-v0.2-EXTENSIONS.md`。  
   - 把前两层约束成“可实现的数据结构”：  
     - v0.1：时间轴/多租户/事实层的最小可用图结构；  
     - v0.2：在 v0.1 上叠加事件时间线、共现、因果与审计能力，对应规划中的阶段 3 和为阶段 7 准备的 TKG 视图。

总体关系可以概括为：

> **本体论基础 → 需求与路径规划 → v0.1/v0.2 Schema → 具体代码与服务**

---

## 3. 推荐参考顺序（按角色）

### 3.1 新加入的架构/算法同学

1. `时空知识图谱的本体论与信息论基础.md`（理解核心问题与理论框架）  
2. `系统讨论_需求与方案总结.md`（理解当前系统与理论的差距）  
3. `视觉记忆基础设施_发展路径规划.md`（理解整体路线与阶段目标）  
4. `TKG-Graph-v0.1-SCHEMA.md`（理解当前阶段必须遵守的图结构约束）  
5. `TKG-Graph-v0.2-EXTENSIONS.md`（如参与事件时间线/因果/共现相关工作）

### 3.2 负责实现存储/Adapter/查询的工程同学

1. `TKG-Graph-v0.1-SCHEMA.md`（首选参考，等价于“头文件”）  
2. `TKG-Graph-v0.2-EXTENSIONS.md`（如实现阶段 3 的图构建/事件时间线/因果）  
3. `视觉记忆基础设施_发展路径规划.md` 中与当前阶段对应的章节（1–3）  
4. `系统讨论_需求与方案总结.md` 作为补充背景（理解为什么这么设计）

### 3.3 负责 TKG/前向推理的同学

1. `TKG-Graph-v0.1-SCHEMA.md`（理解基础实体/事件/时间轴）  
2. `TKG-Graph-v0.2-EXTENSIONS.md`（重点关注 `NEXT_EVENT`、`CAUSES`、`TimeSlice` 与 TKG 视图映射）  
3. `视觉记忆基础设施_发展路径规划.md` 中阶段 3 与阶段 7 章节  
4. `时空知识图谱的本体论与信息论基础.md` 中关于 STF/CI、TKG 模型与时间范式的章节

---

## 4. v0.1 ↔ v0.2 的阶段性定位

- **v0.1（TKG-Graph-v0.1-SCHEMA）**  
  - 对应发展路径规划中的：  
    - 阶段 1：物理时间轴与时空标注落地（MediaSegment + 时间字段）；  
    - 阶段 2：多租户隔离与安全托管（`tenant_id` 全面约束）；  
    - 阶段 3 的“事实图基础”（Event/Entity/Place 的最小结构）。  
  - 目标：  
    - 先把“时间轴 + 多租户 + 证据/身份分层”的基础打牢；  
    - 让 ingestion / 基础检索 /聚类在稳定 Schema 上跑起来。

- **v0.2（TKG-Graph-v0.2-EXTENSIONS）**  
  - 对应发展路径规划中的：  
    - 阶段 3：智能图构建与结构化回想（事件时间线、共现、因果假设、审计）；  
    - 为阶段 7：TKG 前向推理，准备标准化 `(s,r,o,t)` 视图。  
  - 目标：  
    - 在不破坏 v0.1 的前提下，引入事件时间线（`NEXT_EVENT`）、语义共现（`CO_OCCURS_WITH`）、因果假设（`CAUSES`）、审计追踪（`SUPPORTED_BY`）、时间聚合（`TimeSlice`）。  
    - 明确这些高阶边的 `layer`/置信度/来源，保证可控和可观测。

---

## 5. 使用原则

1. **实现代码优先参照 Schema 文档**  
   - 写 Neo4j 模型 / Qdrant payload / Adapter 时，必须以 `TKG-Graph-v0.1-SCHEMA.md` 为唯一真相源；  
   - 引入 v0.2 扩展时，以 `TKG-Graph-v0.2-EXTENSIONS.md` 为补充规范。

2. **架构与规划讨论优先参照理论与路线图**  
   - 讨论“要不要引入新的节点/边/时间范式”时，以《本体论与信息论基础》和《发展路径规划》为依据，再下推到 Schema 层。

3. **任何 Schema 变更都必须同步更新本目录文档**  
   - 修改核心节点/边或新增版本时：  
     - 优先更新/新增 `TKG-Graph-v*.md`；  
     - 在 `PROCESS.md` 中记录本次迭代内容与 rationale；  
     - 如与理论或规划有偏离，需要在对应文档中补充“演进记录”或“偏离说明”。

---

## 6. 版本路线图 v0.1 → v1.0（工程视角）

> 下列版本路线图仅约束“能力/里程碑”，实际代码仓库中的 Tag/Release 可根据需要细分；  
> 所有版本演进必须在 Schema 层（v0.1/v0.2/后续）与 `PROCESS.md` 中留痕。

- **v0.1 — 时间轴 + 多租户 + 图内核可用**  
  - 完成：  
    - 基于 `MediaSegment` 的时间轴与物理时间语义（Time Axis v1）；  
    - `tenant_id` 全链路约束，多租户隔离落地；  
    - `Evidence/Entity/Event/Place` 的最小结构，支持视觉证据与基础实体聚类。  
  - 能力：  
    - 视频 ingest → 切片 → 写入 Segment + 向量 → 生成 Evidence → 简单 Entity 聚类闭环。  

- **v0.2 — 文本记忆接入 & 跨模态统一骨架**  
  - 完成：  
    - 在 Schema 层为文本模态预留并落地：`MediaSegment.modality="text"`、`TextEvidence` 等；  
    - 文本对话 Session 的 ingest 流水线（会话级 Segment + TextEvidence/向量）；  
    - 文本与视觉共享 `Entity/Place`，通过统一时间轴与租户骨架完成“最小跨模态统一”。  
  - 能力：  
    - 文本/视觉都可以在同一时间轴和实体空间下被检索和对齐（尽管尚未有复杂结构化回想）；  
    - 提供基础的 `/dialog/commit` → Segment/TextEvidence → Entity 映射能力。

- **v0.3 — 事件时间线 + 结构化回想能力成形**  
  - 文档侧：  
    - 在规划文档中标记阶段 3（智能图构建与结构化回想）的完成情况与评测结果；  
    - 在 Schema 层仅做必要小修（不破坏 v0.1/v0.2 已有语义）。  
  - 能力：  
    - 落地 `TKG-Graph-v0.2-EXTENSIONS`：`TimeSlice`、`NEXT_EVENT`、`CO_OCCURS_WITH`、`CAUSES`、`SUPPORTED_BY` 等；  
    - 提供面向人物/时间/地点的结构化回想 API（事件序列 + 关键证据），同时覆盖视觉与文本事件；  
    - 上线 EventRecall / CharacterPurity / STFTemporal 等质量指标与评测脚本。

- **v0.4 — 工程地基（CI/CD & 可运维化）**  
  - 文档侧：  
    - 在发展路径规划中细化阶段 4 的部署/监控要求；  
    - 在 README 中补充部署与质量门禁约束。  
  - 能力：  
    - 容器化部署（Docker/K8s）、CI（测试 + 类型 + Lint）、基础监控（per-tenant/per-API 指标）。

- **v0.4–v0.8 — SaaS 化 + TKG 前向推理增强**  
  - 文档侧：  
    - 在发展路径规划中细化阶段 6–7 的产品形态与资源成本；  
    - 在 Schema 扩展文档中补充 TKG 模型所需的最小额外字段（如模型版本、预测时间戳等）。  
  - 能力：  
    - 多租户控制平面、计费/配额、SDK/MCP 工具；  
    - 导出标准 TKG 视图并挂载至少一条 TKG 模型链路（离线训练 + 在线推理），默认作为可选增强模块。

- **v1.0 — 稳定对外版本**  
  - Schema 层：  
    - 冻结核心 Schema（v0.1 内核 + 已稳定的 v0.2 扩展/新增补丁），仅接受兼容性扩展；  
    - 明确任何破坏性变更必须以 v2.x 形式另立新 Schema。  
  - 能力：  
    - 时间/租户/图/文本记忆/SaaS/基础 TKG 全部跑在统一的监控与发布流程下；  
    - 文档、评测与实现完全对齐，可支撑长期维护与外部集成。
